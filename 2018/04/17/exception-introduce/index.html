<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <script>
        var yiliaConfig = {
            fancybox:  true ,
            animate:  true ,
            isHome: false,
            isPost: false,
            isArchive: true,
            isTag: false,
            isCategory: false,
            open_in_new:  true ,
            rootUrl: "\/"
        };
    </script>

    <title>Java异常处理-原理及优化建议</title>
    <link rel="icon" href="https://nicky-chen.github.io/img/favicon.ico">

    <link rel="stylesheet" href="https://nicky-chen.github.io/css/style.css">
    <link rel="stylesheet" href="https://nicky-chen.github.io/font-awesome/css/font-awesome.min.css">
    <link rel="apple-touch-icon" href="https://nicky-chen.github.io/apple-touch-icon.png">


    <link rel="stylesheet" href="https://nicky-chen.github.io/fancybox/jquery.fancybox.css">

    
    
    <link rel="stylesheet" href="https://nicky-chen.github.io/highlight/styles/darcula.css">
    <script src="https://nicky-chen.github.io/highlight/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>


<body>
<div id="container">
    <div class="left-col">
        <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="https://nicky-chen.github.io/" class="profilepic">
            <img src="https://nicky-chen.github.io/img/avatar.png" class="animated zoomIn js-avatar">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="https://nicky-chen.github.io/">nicky_chin</a></h1>
        </hgroup>

        
        <p class="header-subtitle">I can accept failure,but I can&#39;t accept not trying</p>
        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>

                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        

                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>

                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                        <li><a href="https://nicky-chen.github.io/2017/03/17/book_list/" target="_blank">阅读书单</a> </li>
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="https://nicky-chen.github.io/./">主页</a></li>
                        
                            <li><a href="https://nicky-chen.github.io/./tags/">专题分类</a></li>
                        
                            <li><a href="https://nicky-chen.github.io/./post/external/open_source.html">开源项目</a></li>
                        
                            <li><a href="https://nicky-chen.github.io/./post/external/teach_pic.html">技术图谱</a></li>
                        
                            <li><a href="https://nicky-chen.github.io/./post/">归档日志</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="email"><a class="email" target="_blank" href="mailto:shuilianpiying@163.com" title="email"></a></li>
                            
                                <li id="github"><a class="github" target="_blank" href="https://github.com/nicky-chen" title="github"></a></li>
                            
                                <li id="stackoverflow"><a class="stackoverflow" target="_blank" href="https://stackoverflow.com/users/7444060/nicky-chen" title="stackoverflow"></a></li>
                            
                                <li id="简书"><a class="简书" target="_blank" href="https://www.jianshu.com/u/c44ed4847c3d" title="简书"></a></li>
                            
                        </ul>
                    </nav>
                </section>

                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        
                            <a href="https://nicky-chen.github.io/tags/junit" style="font-size: 12px;" class="color3">Junit</a>
                        
                            <a href="https://nicky-chen.github.io/tags/redis" style="font-size: 12px;" class="color2">Redis</a>
                        
                            <a href="https://nicky-chen.github.io/tags/spring-base" style="font-size: 12px;" class="color2">Spring-Base</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E4%BC%98%E5%8C%96" style="font-size: 12px;" class="color4">优化</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E5%88%86%E5%B8%83%E5%BC%8Fid%E6%96%B9%E6%A1%88" style="font-size: 12px;" class="color3">分布式id方案</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E5%88%9B%E5%BB%BA%E5%9E%8B" style="font-size: 12px;" class="color3">创建型</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E5%9F%BA%E7%A1%80" style="font-size: 12px;" class="color3">基础</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B" style="font-size: 12px;" class="color4">多线程</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE" style="font-size: 12px;" class="color4">思维导图</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84" style="font-size: 12px;" class="color4">数据结构</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E6%A1%86%E6%9E%B6%E5%9F%BA%E7%A1%80" style="font-size: 12px;" class="color2">框架基础</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E6%BA%90%E7%A0%81" style="font-size: 12px;" class="color1">源码</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E7%90%86%E8%AE%BA" style="font-size: 12px;" class="color4">理论</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E7%BB%93%E6%9E%84%E5%9E%8B" style="font-size: 12px;" class="color3">结构型</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E8%A1%8C%E4%B8%BA%E5%9E%8B" style="font-size: 12px;" class="color2">行为型</a>
                        
                            <a href="https://nicky-chen.github.io/tags/%E9%94%81%E4%BC%98%E5%8C%96" style="font-size: 12px;" class="color2">锁优化</a>
                        
                    </div>
                </section>
                

                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/alibaba">alibaba开源项目</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/google">google开源项目</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://nicky-chen.github.io/2017/02/19/tools/">在线工具</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://mysql.taobao.org/monthly/">数据库内核月报</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md">系统设计入门</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://tech.meituan.com/">美团技术团队</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://jm.taobao.org/">阿里中间件团队博客</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">大家好，我叫 陈星，来自杭州。平时喜欢打打球，看看书。 我的人生格言：机会是留给有准备的人的，厚积薄发总归会有收获，沉下心来做事情, 才能一往无前......</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
        <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="https://nicky-chen.github.io/" title="回到主页">nicky_chin</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="https://nicky-chen.github.io/" class="profilepic">
                <img src="https://nicky-chen.github.io/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="https://nicky-chen.github.io/" title="回到主页">nicky_chin</a></h1>
            </hgroup>
            
            <p class="header-subtitle">I can accept failure,but I can&#39;t accept not trying</p>
            
            <nav class="header-menu">
                <ul>
                    
                    <li><a href="https://nicky-chen.github.io/./">主页</a></li>
                    
                    <li><a href="https://nicky-chen.github.io/./tags/">专题分类</a></li>
                    
                    <li><a href="https://nicky-chen.github.io/./post/external/open_source.html">开源项目</a></li>
                    
                    <li><a href="https://nicky-chen.github.io/./post/external/teach_pic.html">技术图谱</a></li>
                    
                    <li><a href="https://nicky-chen.github.io/./post/">归档日志</a></li>
                    
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                            <li id="email"><a class="email" target="_blank" href="mailto:shuilianpiying@163.com" title="email"></a></li>
                            
                            <li id="github"><a class="github" target="_blank" href="https://github.com/nicky-chen" title="github"></a></li>
                            
                            <li id="stackoverflow"><a class="stackoverflow" target="_blank" href="https://stackoverflow.com/users/7444060/nicky-chen" title="stackoverflow"></a></li>
                            
                            <li id="简书"><a class="简书" target="_blank" href="https://www.jianshu.com/u/c44ed4847c3d" title="简书"></a></li>
                            
                        </ul>
            </nav>
        </header>
    </div>
</nav>

        <div class="body-wrap">
            <article id="post-js-android" class="article article-type-post" itemscope="" itemprop="blogPost">

    <div class="article-meta">
        <a href="https://nicky-chen.github.io/2018/04/17/exception-introduce/" class="article-date">
            <time datetime="2018-04-17 11:18:15 &#43;0800 CST" itemprop="datePublished">2018-04-17</time>
        </a>
    </div>

    <div class="article-inner">
        
        <input type="hidden" class="isFancy">
        

        <header class="article-header">


            <h1 class="article-title" itemprop="name">
                <a class="article-title" href="https://nicky-chen.github.io/2018/04/17/exception-introduce/">Java异常处理-原理及优化建议</a>
            </h1>


        </header>

        <div class="article-info article-info-post">

            
            <div class="article-category tagcloud">
                
                <a class="article-category-link" href="https://nicky-chen.github.io/categories/java-base/" style="font-size: 12px;">java-base</a>
                
            </div>
            

            
            <div class="article-tag tagcloud">
                <ul class="article-tag-list">
                    
                    <li class="article-tag-list-item">
                        <a class="article-tag-list-link color1" href="https://nicky-chen.github.io/tags/%e5%9f%ba%e7%a1%80/"
                           style="font-size: 12px;">基础</a>
                    </li>
                    
                </ul>
            </div>
            

            <div class="clearfix"></div>
        </div>


        <div class="article-entry" itemprop="articleBody">

            

<h1 id="1-异常层次结构">1 异常层次结构</h1>

<p>异常指不期而至的各种状况，如：文件找不到、网络连接失败、非法参数等。异常是一个事件，它发生在程序运行期间，干扰了正常的指令流程。Java通 过API中Throwable类的众多子类描述各种不同的异常。因而，Java异常都是对象，是Throwable子类的实例，描述了出现在一段编码中的 错误条件。当条件生成时，错误将引发异常。
      Java异常类层次结构图：
<img src="https://upload-images.jianshu.io/upload_images/10175660-248cd3eb6352bfb8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Java异常类层次结构图" /></p>

<p>在 Java 中，所有的异常都有一个共同的祖先 Throwable（可抛出）。Throwable 指定代码中可用异常传播机制通过 Java 应用程序传输的任何问题的共性。
       <strong>Throwable</strong>： 有两个重要的子类：*Exception（异常）和 Error（错误）*，二者都是 Java 异常处理的重要子类，各自都包含大量子类。
       <strong>Error</strong>（错误）:是程序无法处理的错误，表示运行应用程序中较严重问题。大多数错误与代码编写者执行的操作无关，而表示代码运行时 JVM（Java 虚拟机）出现的问题。例如，Java虚拟机运行错误（Virtual MachineError），当 JVM 不再有继续执行操作所需的内存资源时，将出现 OutOfMemoryError。这些异常发生时，Java虚拟机（JVM）一般会选择线程终止。这些错误表示故障发生于虚拟机自身、或者发生在虚拟机试图执行应用时，如Java虚拟机运行错误（Virtual MachineError）、类定义错误（NoClassDefFoundError）等。这些错误是不可查的，因为它们在应用程序的控制和处理能力之 外，而且绝大多数是程序运行时不允许出现的状况。对于设计合理的应用程序来说，即使确实发生了错误，本质上也不应该试图去处理它所引起的异常状况。在 Java中，错误通过Error的子类描述。</p>

<p><strong>Exception</strong>（异常）:是程序本身可以处理的异常。
Exception 类有一个重要的子类 RuntimeException。RuntimeException 类及其子类表示“JVM 常用操作”引发的错误。例如，若试图使用空值对象引用、除数为零或数组越界，则分别引发运行时异常（NullPointerException、ArithmeticException）和 ArrayIndexOutOfBoundException。</p>

<p>通常，Java的异常(包括Exception和Error)分为可查的异常（checked exceptions）和不可查的异常（unchecked exceptions）。</p>

<blockquote>
<p>运行时异常：都是RuntimeException类及其子类异常，如NullPointerException(空指针异常)、IndexOutOfBoundsException(下标越界异常)等，这些异常是不检查异常，程序中可以选择捕获处理，也可以不处理。这些异常一般是由程序逻辑错误引起的，程序应该从逻辑角度尽可能避免这类异常的发生。
运行时异常的特点是Java编译器不会检查它，也就是说，当程序中可能出现这类异常，即使没有用try-catch语句捕获它，也没有用throws子句声明抛出它，也会编译通过。</p>

<p>非运行时异常 （编译异常）：是RuntimeException以外的异常，类型上都属于Exception类及其子类。从程序语法角度讲是必须进行处理的异常，如果不处理，程序就不能编译通过。如IOException、SQLException等以及用户自定义的Exception异常，一般情况下不自定义检查异常。</p>
</blockquote>

<h1 id="2-jvm字节码分析异常处理机制">2 JVM字节码分析异常处理机制</h1>

<p>我们都知道 try、catch、finally语句块的执行顺序:
<img src="https://upload-images.jianshu.io/upload_images/10175660-0f52d611affd9a6f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="try-catch-finally 控制流" /></p>

<p>接下来我们从字节码的角度加深对异常机制的理解，
我们先反编译如下代码：</p>

<pre><code>public class FileDemo {

    private static void divideFun(int a, int b) {
        b = a - b;
    }

    public static void main(String[] args) {
        int a = 1;
        int b = 3;
        try {
            b = a + b;
            FilterInputStream filterInputStream = new BufferedInputStream(new FileInputStream(&quot;d:/a&quot;));
        } catch (FileNotFoundException e) {
            System.out.println(&quot;file error&quot;);
            divideFun(a, b);
        } catch (RuntimeException e) {
            b = a * b;
            throw e;
        } finally {
            a = 0;
        }

    }

}
</code></pre>

<p>通过命令javap -c .\FileDemo.class 反编译.class文件得到一下输出：</p>

<pre><code>PS E:\totalpalce\ContentTest\target\classes\exception&gt; javap -c .\FileDemo.class
Compiled from &quot;FileDemo.java&quot;
public class exception.FileDemo {
  public exception.FileDemo();
    Code:
       0: aload_0  //从局部变量0中装载引用类型值
       1: invokespecial #1  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V 根据编译时类型来调用实例方法
       4: return   //从方法中返回，返回值为void

  public static void main(java.lang.String[]);
    Code:
       0: iconst_1    //将int类型常量1压入栈
       1: istore_1    //将int类型值存入局部变量1  a = 1
       2: iconst_3    //将int类型常量3压入栈
       3: istore_2    //将int类型值存入局部变量2  b = 3

       4: iload_1     //从局部变量1中装载int类型值  异常语句块 start
       5: iload_2     //从局部变量2中装载int类型值
       6: iadd        // 执行int类型的加法    a + b
       7: istore_2    //将int类型值存入局部变量2  b = a + b
       8: new           #2   //创建一个新对象  class java/io/BufferedInputStream
      11: dup         //复制栈顶部一个字长内容
      12: new           #3   // 创建一个新对象 class java/io/FileInputStream
      15: dup         //复制栈顶部一个字长内容
      16: ldc           #4   //把常量池中的 &quot;d:/a&quot; 压入栈
      18: invokespecial #5   //根据编译时类型来调用实例方法 Method java/io/FileInputStream.&quot;&lt;init&gt;&quot;:(Ljava/lang/String;)V
      21: invokespecial #6   //根据编译时类型来调用实例方法 Method java/io/BufferedInputStream.&quot;&lt;init&gt;&quot;:(Ljava/io/InputStream;)V
      24: astore_3    //将引用类型值存入局部变量3
      25: iconst_0    //将int类型常量0压入栈  异常语句块 end

      26: istore_1    //将int类型值存入局部变量1  finally语句块 a = 0
      27: goto          63   //无条件跳转至63

      //碰到 FileNotFoundException时，跳到 30 号指令
      30: astore_3    //将引用类型值存入局部变量3
      31: getstatic     #8   //从类中获取静态字段  Field java/lang/System.out:Ljava/io/PrintStream;
      34: ldc           #9   // 把常量池中的&quot;file error&quot;压入栈
      36: invokevirtual #10  //运行时按照对象的类来调用实例方法 Method java/io/PrintStream.println:(Ljava/lang/String;)V
      39: iload_1     //从局部变量1中装载int类型值
      40: iload_2     //从局部变量2中装载int类型值
      41: invokestatic  #11  // 调用类（静态）方法  Method divideFun:(II)V
      44: iconst_0    //将int类型常量0压入栈
      45: istore_1    //将int类型值存入局部变量1 finally语句块 a = 0
      46: goto          63   //无条件跳转至63

      //碰到 RuntimeException时，跳到 49 号指令
      49: astore_3    //将引用类型值存入局部变量3
      50: iload_1     //从局部变量1中装载int类型值
      51: iload_2     //从局部变量2中装载int类型值
      52: imul        //执行int类型的乘法 a*b
      53: istore_2    //将int类型值存入局部变量2  b = a * b
      54: aload_3     //从局部变量3中装载引用类型值
      55: athrow      //抛出异常或错误 throw e

      //其他未捕获异常时候，跳到 56 号指令
      56: astore        4  // 将引用类型或returnAddress类型值存入局部变量
      58: iconst_0    //将int类型常量0压入栈
      59: istore_1    //将int类型值存入局部变量1 finally语句块 a = 0
      60: aload         4  //从局部变量中装载引用类型值（refernce）
      62: athrow      //抛出异常或错误
      63: return      //从方法中返回，返回值为void
    Exception table:  // 异常表
       from    to  target type
           4    25    30   Class java/io/FileNotFoundException //4-25号指令中，碰到 FileNotFoundException时，跳到 30 号指令
           4    25    49   Class java/lang/RuntimeException
           4    25    56   any
          30    44    56   any
          49    58    56   any

</code></pre>

<p>通过以上指令，我们能够理解，生成字节码指令的时候，会有一张异常表，记录发生异常情况，跳转到哪一条指令，捕获的异常会在字节码指令中跟踪 try语句块中的代码，当出现该异常的时候跳转到相应catch内部的语句块和最后的finally语句块，如果出现的异常是我们未捕获的，则会走finally的逻辑，并抛出异常错误返回</p>

<p>为了更好的理解我们可以看下面字节码指令结构图：
<img src="https://upload-images.jianshu.io/upload_images/10175660-f388282f852fc14f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="异常字节码指令图" /></p>

<h1 id="3-java异常处理的一般性建议">3 Java异常处理的一般性建议</h1>

<blockquote>
<p>try-catch-finally 规则 异常处理语句的语法规则：
1)  必须在 try 之后添加 catch 或 finally 块。try 块后可同时接 catch 和 finally 块，但至少有一个块。
2) 必须遵循块顺序：若代码同时使用 catch 和 finally 块，则必须将 catch 块放在 try 块之后。
3) catch 块与相应的异常类的类型相关。
4) 一个 try 块可能有多个 catch 块。若如此，则执行第一个匹配块。即Java虚拟机会把实际抛出的异常对象依次和各个catch代码块声明的异常类型匹配，如果异常对象为某个异常类型或其子类的实例，就执行这个catch代码块，不会再执行其他的 catch代码块
5) 可嵌套 try-catch-finally 结构。
6) 在 try-catch-finally 结构中，可重新抛出异常。
7) 除了下列情况，总将执行 finally 做为结束：JVM 过早终止（调用 System.exit(int)）；在 finally 块中抛出一个未处理的异常；计算机断电、失火、或遭遇病毒攻击。</p>

<p>Throws抛出异常的规则：
1) 如果是不可查异常（unchecked exception），即Error、RuntimeException或它们的子类，那么可以不使用throws关键字来声明要抛出的异常，编译仍能顺利通过，但在运行时会被系统抛出。
2) 必须声明方法可抛出的任何可查异常（checked exception）。即如果一个方法可能出现受可查异常，要么用try-catch语句捕获，要么用throws子句声明将它抛出，否则会导致编译错误
3) 仅当抛出了异常，该方法的调用者才必须处理或者重新抛出该异常。当方法的调用者无力处理该异常的时候，应该继续抛出，而不是囫囵吞枣。
4) 调用方法必须遵循任何可查异常的处理和声明规则。若覆盖一个方法，则不能声明与覆盖方法不同的异常。声明的任何异常必须是被覆盖方法所声明异常的同类或子类。</p>
</blockquote>

<h1 id="4-异常处理优化">4 异常处理优化</h1>

<h5 id="4-1-java7中io的异常处理-try-with-resource">4. 1 Java7中IO的异常处理 try-with-resource</h5>

<p>try-with-resources语句是一种声明了一种或多种资源的try语句。资源是指在程序用完了之后必须要关闭的对象。try-with-resources语句保证了每个声明了的资源在语句结束的时候都会被关闭。任何实现了java.lang.AutoCloseable接口的对象，和实现了java.io.Closeable接口的对象，都可以当做资源使用。</p>

<pre><code>public class FileHandlerOptimize {

    private static void printFile() throws IOException {
        InputStream input = null;

        try {
            input = new FileInputStream(&quot;D:/user.txt&quot;);

            int data = input.read();
            while (data != -1) {
                System.out.print((char) data);
                data = input.read();
            }
        } finally {
            if (input != null) {
                input.close();
            }
        }
    }

    //单个流关闭
    private static void printFileJava7() throws IOException {

        try (FileInputStream input = new FileInputStream(&quot;D:/user.txt&quot;)) {

            int data = input.read();
            while (data != -1) {
                System.out.print((char) data);
                data = input.read();
            }
        }
    }

    //如果需要对多个流自动关闭
    private static void printFileJava7Multiple() throws IOException {
//你可以在一个try-with-resources语句里面声明多个资源
        try (FileInputStream input = new FileInputStream(&quot;D:/user.txt&quot;);
                BufferedInputStream bufferedInput = new BufferedInputStream(input)) {

            int data = bufferedInput.read();
            while (data != -1) {
                System.out.print((char) data);
                data = bufferedInput.read();
            }
        }
    }

    public static void main(String[] args) throws Exception {
        //单个流处理
        printFileJava7();
        //多个流处理
        printFileJava7Multiple();
    }
}
</code></pre>

<p>这是java7的新特性比较简单，但是它做了一定的优化,你反编译.class文件会发现新增了一行代码如下：</p>

<pre><code>    private static void printFileJava7() throws IOException {
        FileInputStream input = new FileInputStream(&quot;D:/user.txt&quot;);
        Throwable var1 = null;
        try {
            for(int data = input.read(); data != -1; data = input.read()) {
                System.out.print((char)data);
            }
        } catch (Throwable var10) {
            var1 = var10;
            throw var10;
        } finally {
            if (input != null) {
                if (var1 != null) {
                    try {
                        input.close();
                    } catch (Throwable var9) {
                        var1.addSuppressed(var9);
                    }
                } else {
                    input.close();
                }
            }
        }
    }
</code></pre>

<p>多了 <em>var1.addSuppressed(var9);</em> 这行代码，从Java 1.7开始，大佬们为Throwable类新增了addSuppressed方法，支持将一个异常附加到另一个异常身上，从而当出现两个以上的异常时，避免异常被屏蔽覆盖</p>

<h5 id="4-2-java异常处理模板">4.2 Java异常处理模板</h5>

<p>对如下代码进行优化：</p>

<pre><code>    public static void readFile() throws IOException {
        byte[] buff = new byte[1024];
        FileInputStream input = null;
        try {
            input = new FileInputStream(new File(&quot;D:/user.txt&quot;));
            while (-1 != input.read(buff)) {
                System.out.println(new String(buff));
            }
        } catch (IOException e) {
            e.getMessage();
            throw e;
        } finally {
            if (null != input) {
                try {
                    input.close();
                } catch (IOException e) {
                    e.getMessage();
                    throw e;
                }
            }
        }
    }
</code></pre>

<p>注意: 上面的例子实际上存在异常丢失的隐患, 如果第一个try中出现异常, 接着在执行finally中的input.close()也出现异常, 这时main 方法只能接收到input.close的异常信息, 第一个异常会被覆盖, 导致异常信息丢失</p>

<p>所以正确的写法如下:</p>

<pre><code>public class FileReadDemo {  
    public void readFile() throws ApplicationException {  
        byte[] buff = new byte[1024];  
        IOException processException = null;  
        FileInputStream input = null;  
        try {  
            input = new FileInputStream(new File(&quot;D:/user.txt&quot;));  
            while (-1 != input.read(buff)) {  
                System.out.println(new String(buff));  
            }  
        } catch (IOException e) {  
            processException = e;  
        } finally {  
            try {  
                if(null != input){  
                    input.close();  
                }  
            } catch (IOException e) {  
                if(null == processException){  
                    throw new ApplicationException(e);  
                }else{  
                    throw new MyException(&quot;FileInputStream close exception&quot;, processException);  
                }  
            }  
            if(processException !=null){  
                throw new MyException(processException);  
            }  
        }  
          
    }  
  
    public static void main(String[] args){  
        try {  
            readFile();  
        } catch (ApplicationException e) {  
            e.printStackTrace();  
        }  
          
    }  
}  
</code></pre>

<p>这种写法是不是很糟糕, 我们实际关注的代码就只是第一个try中的四行代码, 这样的缺陷很明显, 一旦系统中有多处地方要用到类似的文件处理操作时, 就需要重复的做try-catch-finally, 很明显, 这就违背了程序开发中的一个重要原则: DRY(Don’t repeat yourself), 代码重复, 不容易阅读和维护, 同时也存在一个隐患, 忘记关闭, 异常没正确处理等, 引入模板方法就可以很好的解决这个问题.</p>

<pre><code>public class MyException extends RuntimeException {

    public MyException() {
        super();
    }

    public MyException(String message) {
        super(message);
    }

    public MyException(String message, Throwable cause) {
        super(message, cause);
    }

    public MyException(Throwable cause, String message) {
        super(message, cause);

    }

    public MyException(Throwable suppressed, Throwable throwable, String message) {
        super(message, throwable);
//多异常覆盖问题
        throwable.addSuppressed(suppressed);
    }

    public MyException(Throwable cause) {
        super(cause);
    }

    protected MyException(String message, Throwable cause, boolean enableSuppression, boolean writableStackTrace) {
        super(message, cause, enableSuppression, writableStackTrace);
    }
}
</code></pre>

<p>提取重复代码</p>

<pre><code>public abstract class InputStreamProcessingTemplate {

    public void process(String fileName) {
        //防止异常信息丢失
        IOException processException = null;
        InputStream input = null;
        try {
            input = new FileInputStream(fileName);

            doProcess(input);
        } catch (IOException e) {
            processException = e;
        } finally {
            processExceptionHandle(fileName, processException, input);
        }
    }

    //override this method in a subclass, to process the stream.
    public abstract void doProcess(InputStream input) throws IOException;

    private static void processExceptionHandle(String fileName, IOException processException, InputStream input) {
        if (input != null) {
            try {
                input.close();
            } catch (IOException e) {
                if (processException != null) {
                    //防止异常信息丢失
                    throw new MyException(processException, e, &quot;Error message...&quot; + fileName);
                }
                throw new MyException(e, &quot;Error closing InputStream for file &quot; + fileName);
            }
        }
        if (processException != null) {
            throw new MyException(processException, &quot;Error processing InputStream for file &quot; + fileName);
        }
    }
}
</code></pre>

<p>通过这种方式，我们发现我们需要处理逻辑，不需要考虑流的关闭问题</p>

<pre><code>public class Test {

    public static void main(String[] args) {
        new InputStreamProcessingTemplate(){
            @Override
            public void doProcess(InputStream input) throws IOException {
                byte[] buff = new byte[1024];
                while(input.read(buff) != -1){
                    //do something with the chars...
                    System.out.println(new String(buff));
                }
            }
        }.process(&quot;D:\\user.txt&quot;);
    }
}
</code></pre>

<p>或者使用静态模板方法</p>

<pre><code>public interface InputStreamProcessor {

    public void process(InputStream input) throws IOException;

}
</code></pre>

<p>静态方法</p>

<pre><code>public class InputStreamProcessingTemplate {

    public static void process(String fileName, InputStreamProcessor processor) {
        //防止异常信息丢失
        IOException processException = null;
        InputStream input = null;
        try {
            input = new FileInputStream(fileName);
            processor.process(input);
        } catch (IOException e) {
            processException = e;
        } finally {
            processExceptionHandle(fileName, processException, input);

        }
    }

    private static void processExceptionHandle(String fileName, IOException processException, InputStream input) {
        if (input != null) {
            try {
                input.close();
            } catch (IOException e) {
                if (processException != null) {
                    //防止异常信息丢失
                    throw new MyException(processException, e, &quot;Error message...&quot; + fileName);
                }
                throw new MyException(e, &quot;Error closing InputStream for file &quot; + fileName);
            }
        }
        if (processException != null) {
            throw new MyException(processException, &quot;Error processing InputStream for file &quot; + fileName);
        }
    }
}
</code></pre>

<p>这样看上出代码更加简洁优雅</p>

<pre><code>public class Test {

    public static void main(String[] args) {
        InputStreamProcessingTemplate.process(&quot;D:\\user.txt&quot;, input -&gt; {
            byte[] buff = new byte[1024];
            while(input.read(buff) != -1){
                //do something with the chars...
                System.out.println(new String(buff));
            }
        });
    }
}
</code></pre>

<h5 id="4-3-java8中的异常简化">4.3 java8中的异常简化</h5>

<p>实现 Supplier<T> 提供型接口</p>

<pre><code>public class MyException extends RuntimeException implements Supplier&lt;RuntimeException&gt; {

    public MyException() {
        super();
    }

    public MyException(String message) {
        super(message);
    }

    public MyException(String message, Throwable cause) {
        super(message, cause);
    }

    public MyException(Throwable cause, String message) {
        super(message, cause);

    }

    public MyException(Throwable suppressed, Throwable throwable, String message) {
        super(message, throwable);
        throwable.addSuppressed(suppressed);
    }

    public MyException(Throwable cause) {
        super(cause);
    }

    protected MyException(String message, Throwable cause, boolean enableSuppression, boolean writableStackTrace) {
        super(message, cause, enableSuppression, writableStackTrace);
    }

    @Override public RuntimeException get() {
        return this;
    }
</code></pre>

<p>如此我们可以简化我们的NPE判断
原先我们都是这样</p>

<pre><code>if (user == null) {
            throw new MyException();
        }
if (user.getAge() == null) {
            throw new MyException();
        }
</code></pre>

<p>现在可以这样</p>

<pre><code>Optional.ofNullable(Optional.ofNullable(user).orElseThrow(MyException::new).getAge()).orElseThrow(MyException::new);
</code></pre>

<h5 id="4-4-异常增强">4.4 异常增强</h5>

<p>我们在平时的软件开发中一般都是进行异常包装，包括其中的 错误码 和 错误信息，
来提示我们程序错误的原因，例如下面例子：</p>

<pre><code>public void method3() throws EnrichableException{
     try{
        method1(); 
     } catch(EnrichableException e){
        e.addInfo(&quot;An error occurred when trying to ...&quot;);
        throw e;
     }
  }

  public void method2() throws EnrichableException{
     try{
        method1(); 
     } catch(EnrichableException e){
        e.addInfo(&quot;An error occurred when trying to ...&quot;);
        throw e;
     }
  }
  
  public void method1() throws EnrichableException {
     if(...) throw new EnrichableException(
        &quot;ERROR1&quot;, &quot;Original error message&quot;);   
  }
</code></pre>

<p>方法method1抛出一个异常，通过唯一的错误码标识“ERROR1”。请注意，method1（）被method2（）和method3（）调用。尽管在method1（）方法中，进行了异常信息记录，但是无论在方法method2和method3中运行的时候method1出错，封装的错误结果都是相同的，但是对于开发人员来说，确定是具体是哪一个方法出的问题这可能很重要。错误码“ERROR1”足以确定错误发生在哪里，但不知道在哪个上下文中出现的情况。</p>

<p>解决这个问题的方法是在异常中添加唯一的上下文错误代码，就像添加其他上下文信息一样。这里有一个例子，addInfo（）方法已经被更改以适应以下情况</p>

<pre><code>public void method3() throws EnrichableException{
     try{
        method1(); 
     } catch(EnrichableException e){
        e.addInfo(&quot;METHOD3&quot;, &quot;ERROR1&quot;,
            &quot;An error occurred when trying to ...&quot;);
        throw e;
     }
  }

  public void method2() throws EnrichableException{
     try{
        method1(); 
     } catch(EnrichableException e){
        e.addInfo(&quot;METHOD2&quot;, &quot;ERROR1&quot;,
            &quot;An error occurred when trying to ...&quot;);
        throw e;
     }
  }
  
  public void method1() throws EnrichableException {
     if(...) throw new EnrichableException(
        &quot;METHOD1&quot;, &quot;ERROR1&quot;, &quot;Original error message&quot;);   
  }
</code></pre>

<p>这样当method1（）从method3（）调用时，错误标识将如下所显示：</p>

<pre><code>[METHOD3:ERROR1][METHOD1:ERROR1]
</code></pre>

<p>我们就可以确定方法出错的位置和调用链</p>

<p>而异常增强，则是有这种需求场景的前提下，通过添加异常调用链信息，追踪问题
代码如下：
异常句柄</p>

<pre><code>public interface ExceptionHandler {

    void handle(String contextCode, String errorCode,
            String errorText, Throwable t);

    void raise(String contextCode, String errorCode,
            String errorText);
}
</code></pre>

<p>异常类</p>

<pre><code>public class EnrichableException  extends RuntimeException {

    public static final long serialVersionUID = -1;

    private List&lt;InfoItem&gt; infoItems = new ArrayList&lt;&gt;();

    private class InfoItem {

        private String errorContext;

        private String errorCode;

        private String errorText;

        private InfoItem(String contextCode, String errorCode, String errorText) {

            this.errorContext = contextCode;
            this.errorCode = errorCode;
            this.errorText = errorText;
        }
    }

    public EnrichableException(String errorContext, String errorCode, String errorMessage) {

        addInfo(errorContext, errorCode, errorMessage);
    }

    public EnrichableException(String errorContext, String errorCode, String errorMessage, Throwable cause) {
        super(cause);
        addInfo(errorContext, errorCode, errorMessage);
    }

    public EnrichableException addInfo(String errorContext, String errorCode, String errorText) {

        this.infoItems.add(new InfoItem(errorContext, errorCode, errorText));
        return this;
    }

    public String getCode() {
        StringBuilder builder = new StringBuilder();

        for (int i = this.infoItems.size() - 1; i &gt;= 0; i--) {
            InfoItem info = this.infoItems.get(i);
            builder.append('[');
            builder.append(info.errorContext);
            builder.append(':');
            builder.append(info.errorCode);
            builder.append(']');
        }

        return builder.toString();
    }

    @Override public String toString() {
        StringBuilder builder = new StringBuilder();

        builder.append(getCode());
        builder.append('\n');

        //append additional context information.
        for (int i = this.infoItems.size() - 1; i &gt;= 0; i--) {
            InfoItem info = this.infoItems.get(i);
            builder.append('[');
            builder.append(info.errorContext);
            builder.append(':');
            builder.append(info.errorCode);
            builder.append(']');
            builder.append(info.errorText);
            if (i &gt; 0) {
                builder.append('\n');
            }
        }

        //append root causes and text from this exception first.
        if (getMessage() != null) {
            builder.append('\n');
            if (getCause() == null) {
                builder.append(getMessage());
            } else if (!getMessage().equals(getCause().toString())) {
                builder.append(getMessage());
            }
        }
        appendException(builder, getCause());

        return builder.toString();
    }

    private void appendException(StringBuilder builder, Throwable throwable) {
        if (throwable == null) {
            return;
        }
        appendException(builder, throwable.getCause());
        builder.append(throwable.toString());
        builder.append('\n');
    }

}
</code></pre>

<p>测试类</p>

<pre><code>public class ExceptionTest {
    protected ExceptionHandler exceptionHandler = new ExceptionHandler(){
        @Override
        public void handle(String errorContext, String errorCode,
                String errorText, Throwable t){

            if(! (t instanceof EnrichableException)){
                throw new EnrichableException(
                        errorContext, errorCode, errorText, t);
            } else {
                ((EnrichableException) t).addInfo(
                        errorContext, errorCode, errorText);
            }
        }

        @Override
        public void raise(String errorContext, String errorCode,
                String errorText){
            throw new EnrichableException(
                    errorContext, errorCode, errorText);
        }
    };

    public static void main(String[] args){
        ExceptionTest test = new ExceptionTest();
        try{
            test.level1();
        } catch(Exception e){
            e.printStackTrace();
        }
    }

    public void level1(){
        try{
            level2();
        } catch (EnrichableException e){
            this.exceptionHandler.handle(
                    &quot;L1&quot;, &quot;E1&quot;, &quot;Error in level 1, calling level 2&quot;, e);
            throw e;
        }
    }

    public void level2(){
        try{
            level3();
        } catch (EnrichableException e){
            this.exceptionHandler.handle(
                    &quot;L2&quot;, &quot;E2&quot;, &quot;Error in level 2, calling level 3&quot;, e);
            throw e;
        }
    }

    public void level3(){
        try{
            level4();
        } catch(Exception e){
            this.exceptionHandler.handle(
                    &quot;L3&quot;, &quot;E3&quot;, &quot;Error at level 3&quot;, e);
        }
    }

    public void level4(){
        throw new IllegalArgumentException(&quot;incorrect argument passed&quot;);
    }
}
</code></pre>

<p>运行main方法结果如下
&gt;[L1:E1][L2:E2][L3:E3]
[L1:E1]Error in level 1, calling level 2
[L2:E2]Error in level 2, calling level 3
[L3:E3]Error at level 3
java.lang.IllegalArgumentException: incorrect argument passed</p>

<p>我们可以清晰的定位在哪个流程中函数调用出现了异常</p>

<h1 id="reference">Reference</h1>

<p><a href="http://tutorials.jenkov.com/java-exception-handling/index.html">Java Exception Handling</a>
<a href="https://unmi.cc/jvm-java-handle-try-catch/">JVM 对 Java 异常的处理原理</a>
<a href="http://ifeve.com/java-exception/">JAVA异常处理</a>
<a href="https://blog.csdn.net/piaohai/article/details/50387238">异常管理 - try-catch-finally异常信息丢失</a>
<a href="http://www.kissyu.org/2016/10/06/深入理解Java%20try-with-resource/?utm_source=tuicool&amp;utm_medium=referral">深入理解Java try-with-resource</a></p>


        </div>

    </div>

    
    <nav id="article-nav">

        
        <div id="article-nav-newer" class="article-nav-title">
            <a href="https://nicky-chen.github.io/2018/04/21/string-builder-question/">
                字符串拼接的疑惑
            </a>
        </div>
        

        
        <div id="article-nav-older" class="article-nav-title">
            <a href="https://nicky-chen.github.io/2018/04/03/thread-jmm-happens-before/">
                java内存模型之[JMM][重排序][happens-before]
            </a>
        </div>
        

    </nav>
    


</article>

<div id="toc" class="toc-article" >
    <strong class="toc-title">文章目录</strong>
    <ol class="toc">
        <nav id="TableOfContents">
<ul>
<li><a href="#1-异常层次结构">1 异常层次结构</a></li>
<li><a href="#2-jvm字节码分析异常处理机制">2 JVM字节码分析异常处理机制</a></li>
<li><a href="#3-java异常处理的一般性建议">3 Java异常处理的一般性建议</a></li>
<li><a href="#4-异常处理优化">4 异常处理优化</a>
<ul>
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#4-1-java7中io的异常处理-try-with-resource">4. 1 Java7中IO的异常处理 try-with-resource</a></li>
<li><a href="#4-2-java异常处理模板">4.2 Java异常处理模板</a></li>
<li><a href="#4-3-java8中的异常简化">4.3 java8中的异常简化</a></li>
<li><a href="#4-4-异常增强">4.4 异常增强</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
<li><a href="#reference">Reference</a></li>
</ul>
</nav>
    </ol>
</div>
<style>
    
    .left-col .switch-btn {
        display: none;
    }

    .left-col .switch-area {
        display: none;
    }
    


</style>

<input type="button" id="tocButton" value="隐藏目录" title="点击按钮隐藏或者显示文章目录" >

<script src="//7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }

    $("#tocButton").click(function () {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
            $(".switch-btn, .switch-area").fadeOut(300);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
            $(".switch-btn, .switch-area").fadeIn(500);
        }
    })

    
    
    
        
    
</script>


<div class="share">
    <div class="bdsharebuttonbox">
        <a href="#" class="bds_copy" data-cmd="copy" title="复制网址"></a>
        <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
        <a class="bds_qzone" data-cmd="qzone" href="#" title="分享到 QQ 空间"></a>
        <a href="#" class="bds_mail" data-cmd="mail" title="通过邮件分享"></a>
        <a href="#" class="bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
        <a class="bds_count" data-cmd="count"></a>
        <a class="bds_more" data-cmd="more"></a>

    </div>
    <script>
        window._bd_share_config = {
            "common": {
                "bdSnsKey": {},
                "bdText": "",
                "bdMini": "2",
                "bdMiniList": false,
                "bdPic": "",
                "bdStyle": "0",
                "bdSize": "24"
            }, "share": {}
        };
        with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = '/static/api/js/share.js?cdnversion=' + ~(-new Date() / 36e5)];
    </script>
</div>




<div style="margin-left: 30px;margin-right: 30px;background: white;padding-left: 30px;padding-right: 30px">
    <div class="comments">
        <h3>COMMENTS</h3>
        <script type="text/javascript">
            (function() {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'https://nicky-chen.disqus.com/embed.js';
                dsq.setAttribute('data-timestamp', +new Date());
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <div id="disqus_thread"></div>

    </div>
</div>







<div class="scroll" id="post-nav-button">

    
    <a href="https://nicky-chen.github.io/2018/04/21/string-builder-question/" title="上一篇: 字符串拼接的疑惑">
        <i class="fa fa-angle-left"></i>
    </a>
    


    <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>


    
    <a href="https://nicky-chen.github.io/2018/04/03/thread-jmm-happens-before/" title="下一篇: java内存模型之[JMM][重排序][happens-before]">
        <i class="fa fa-angle-right"></i>
    </a>
    

</div>


<ul class="post-list toc-article">
    
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2019/05/03/apt_lombok_implement/" target="_blank">基于APT(注解处理器)实现Lombok的@getter @setter @toString功能</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/12/19/state-machine/" target="_blank">实际项目运用之State模式（状态模式）</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/11/17/btree-info/" target="_blank">数据结构之BTree和B&#43;Tree(多路平衡查找树 )</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/10/15/id-redis/" target="_blank">分布式全局序列ID方案之Redis优化方案</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/09/25/id-flicker/" target="_blank">分布式全局序列ID方案之Flicker优化方案</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/09/19/id-snowflake/" target="_blank">分布式全局序列ID方案之Snowflake算法</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/08/25/spring-springmvc/" target="_blank">Spring之动手实现SpringMVC功能</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/08/22/java-methodhandler/" target="_blank">Java反射优化之方法句柄</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/08/16/spring-bean-ioc/" target="_blank">Spring之动手实现IOC功能</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/08/12/spring-bean-lifecycle/" target="_blank">Spring之Bean加载-解析-生命周期</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/08/09/aqs-condition/" target="_blank">并发基础之Condition(等待队列)</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/08/07/cache-redis-optimize/" target="_blank">Redis注意事项及常见优化</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/08/04/aqs_chapter02/" target="_blank">并发基础之AQS同步器（二）</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/08/01/cache-redis-slowlog/" target="_blank">Redis之慢查询日志</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/07/31/aqs_chapter01/" target="_blank">并发基础之AQS同步器（一）</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/07/16/junit-codeanalysis/" target="_blank">初窥门径之JUnit源码分析</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/07/13/java-securitymanager/" target="_blank">Java安全之SecurityManager</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/07/05/spi-introduction/" target="_blank">框架基础之SPI机制</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/06/29/responsibility-chain/" target="_blank">实际项目运用之Responsibility-Chain模式（责任链模式）</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/06/25/jndi-introdution/" target="_blank">JNDI知识摘要</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/06/17/architect/" target="_blank">技术图谱</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/06/13/distribution-knowledge/" target="_blank">分布式项目知识要点</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/06/07/singletion/" target="_blank">设计模式之单例模式终极版【克隆-序列化-反射】</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/06/02/fail-fast-safe/" target="_blank">Fail-Fast和Fail-Safe机制</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/05/27/adapter/" target="_blank">实际项目运用之Adapter模式（适配器模式）</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/05/18/template/" target="_blank">设计模式之Template模式（模版模式）</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/05/14/synchronized-principle/" target="_blank">synchronized实现原理及锁优化</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/05/13/juc-tree-info/" target="_blank">JUC知识点总结</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/05/06/strategy/" target="_blank">实际项目运用之Strategy模式（策略模式）</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/05/04/volatile-feature/" target="_blank">volatile关键字原理实现及应用</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/04/28/high-event/" target="_blank">MYSQL高级特性之【Event事件】</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/04/27/process-fun/" target="_blank">MYSQL高级特性之【存储过程与函数】</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/04/25/cap-base-flp/" target="_blank">分布式之【CAP理论、BASE理论 、FLP不可能定理】</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/04/21/string-builder-question/" target="_blank">字符串拼接的疑惑</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/04/17/exception-introduce/" target="_blank">Java异常处理-原理及优化建议</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/04/03/thread-jmm-happens-before/" target="_blank">java内存模型之[JMM][重排序][happens-before]</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/03/28/decorator/" target="_blank">实际项目运用之Decorator模式（装饰器模式）</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/03/26/interface-idempotency/" target="_blank">接口设计的幂等性考虑</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/03/21/binary-operation/" target="_blank">java中位运算技巧</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/03/20/classloader-chapter02/" target="_blank">ClassLoader类加载分析（二）</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/03/13/introspector/" target="_blank">Java 内省(Introspector)</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2018/03/08/classloader-chapter01/" target="_blank">ClassLoader类加载分析（一）</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2017/12/19/builder/" target="_blank">设计模式之builder模式</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2017/12/07/builder-factory/" target="_blank">设计模式之factory模式</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2017/11/03/recursive-lock/" target="_blank">可重入锁</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2017/09/12/show-global-status/" target="_blank">库级优化之SHOW GLOBAL STATUS</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2017/06/13/optimize-picture/" target="_blank">后端开发需要了解的mysql优化方向</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2017/05/16/thread-communication/" target="_blank">多线程之线程通信摘要</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2017/05/07/design-rule/" target="_blank">数据库设计三范式和反范式</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2017/03/17/book_list/" target="_blank">阅读书单</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2017/02/19/open_source/" target="_blank">开源项目</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2017/02/19/tools/" target="_blank">在线工具</a></li>
    
    <li class="post-list-item"><a class="post-list-link" href="https://nicky-chen.github.io/2017/01/23/externalizable-interface/" target="_blank">自定义序列化之Externalizable接口</a></li>
    
</ul>

<script src="//7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    $(".post-list").addClass("toc-article");
    $(".post-list-item a").attr("target", "_blank");
    $("#post-nav-button > a:nth-child(2)").click(function () {
        $(".fa-bars, .fa-times").toggle();
        $(".post-list").toggle(300);
        if ($(".toc").length > 0) {
            $("#toc, #tocButton").toggle(200, function () {
                if ($(".switch-area").is(":visible")) {
                    $("#toc, .switch-btn, .switch-area").toggle();
                    $("#tocButton").attr("value", valueHide);
                }
            })
        }
        else {
            $(".switch-btn, .switch-area").fadeToggle(300);
        }
    })
</script>


<script>

</script>


        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2019 nicky_chin
            </div>
            <div class="footer-right">
                <a href="https://github.com/laozhu/hugo-nuo" target="_blank">Hugo Theme </a>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >本站到访数:
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量:
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://nicky-chen.github.io/js/GithubRepoWidget.js"></script>
<script src="//7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="https://nicky-chen.github.io/js/main.js"></script>


    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum =  5 ;
                var backgroundimg = "url(\/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-119892182-1', 'auto');
ga('send', 'pageview');

</script>






<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>




<script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

</div>
</body>
</html>
